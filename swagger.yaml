openapi: "3.0.0"

info:
  title: Navigator Sharing Data
  description: Data collected by navigator
  version: 0.1.2


servers:
  - url: /api/v1

tags:
- name: Tasks
  description: navigation task generated by app
- name: Positions
  description: real-time device position
- name: Tracks
  description: routing data calculated by app

paths:
  #Start task
  
  /task/{taskId}:
    get:
      tags:
      - Tasks
      summary: Finds task by id
      operationId: findTask
      x-openapi-router-controller: api.tasks
      parameters:
      - name: taskId
        in: path
        description: ID of task that needs to be found. ID was generated By Server. 
        required: true
        schema:
          type: string
          
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Task'
        '400':
          description: Invalid ID supplied
        '404':
          description: A task with the specified ID was not found.
    
  /task/:
    post:
      tags:
        - Tasks
      summary: Create a new Task
      description: ""
      operationId: addTask
      x-openapi-router-controller: api.tasks
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Task'
              
      responses:
        '200':
          description: Return taskId generated by server.
        '400':
          description: Invalid ID supplied
        '404':
          description: A task with the specified ID was not found.
      
          
  #Start position 
  /position/findLatest/{taskId}:
    get:
      tags:
      - Positions
      summary: Finds latest position data by task
      operationId: findLatestPosition
      x-openapi-router-controller: api.positions
      parameters:
      - name: taskId
        in: path
        description: ID of task that needs to be found. ID was generated By Server.

        required: true
        schema:
          type: string
          
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Position'
        '400':
          description: Invalid ID supplied
        '404':
          description: A task with the specified ID was not found.

  /position/{taskId}:
    post:
      tags:
        - Positions
      summary: Add a new position record to the database
      operationId: addPosition
      x-openapi-router-controller: api.positions
      parameters:
      - name: taskId
        in: path
        description: ID of position that needs to be added
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Position'
      
      responses:
        '200':
          description: Success
        '400':
          description: Invalid ID supplied
        '404':
          description: A task with the specified ID was not found.
  
          
  #Start track 
  /track/findLatest/{taskId}:
    get:
      tags:
      - Tracks
      summary: Finds latest track data by task
      operationId: findLatestTrack
      x-openapi-router-controller: api.tracks
      parameters:
      - name: taskId
        in: path
        description: ID of task that needs to be found. ID was generated By Server.
        required: true
        schema:
          type: string
          
      responses:
        '200':
          description: successful operation
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Track'
        '400':
          description: Invalid ID supplied
        '404':
          description: A task with the specified ID was not found.
        
  /track/{taskId}:
    post:
      tags:
        - Tracks
      summary: Add a new track record to the database
      operationId: addTrack
      x-openapi-router-controller: api.tracks
      parameters:
      - name: taskId
        in: path
        description: ID of position that needs to be added
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/Track'
      
      responses:
        '200':
          description: Success
        '400':
          description: Invalid ID supplied
        '404':
          description: A task with the specified ID was not found.


#Start Component
components:
  schemas:
    Task:
      properties:
        departure_longitude:
          type: number
          description: start position
        departure_latitude:
          type: number
          description: start position
        accident_longitude:
          type: number
        accident_latitude:
          type: number
        hospital_longitude:
          type: number
        hospital_latitude:
          type: number
        # destination:
        #   type: array
        #   items:
        #     type: string
        #   minItems: 1
      # All properties are required
      required:  
        - departure_longitude
        - departure_latitude
        - accident_longitude
        - accident_latitude
        - hospital_longitude
        - hospital_latitude
    Position:
      properties:
        createdTime:
          type: string
          description: EpocTime. ex. 1593525939 would be 2020-06-30T14:04:16+00:00
          example: "1593525939"
        estimatedArriveTime:
          type: number
          description: Estimated arriving time. ex. value 10.0 presents 10 minutes
          example: 10
        latitude:
          type: number
        longitude:
          type: number
        # Speed:
        #   type: "integer"
        #   format: "int64"
        #   example: "60"
        # DirectionAngle:
        #   type: "integer"
        #   description: "0-360 degree"
        #   example: 30
        # Status:
        #   type: "string"
      required:
        - createdTime
        - estimatedArriveTime
        - latitude
        - longitude
    Track:
        properties:
          createdTime:
            type: string
            description: EpocTime. ex. 1593525939 would be 2020-06-30T14:04:16+00:00
            example: 1593525939
          content:
            type: string
            description: encoded route data
        required:
          - createdTime
          - content
